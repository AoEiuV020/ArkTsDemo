# 代码重构流程规范

本规范适用于大规模代码重构，确保重构过程有序、安全、可追溯。

---

## 重构流程

1. **确认设计规范** - 确保相关规范存在且最新
2. **编写设计文档** - 只描述重构后的结果，禁止过程性描述
3. **检查设计** - 规范符合性、功能完整性、技术可行性
4. **备份旧代码** - 使用 git 导出当前版本到指定目录
5. **执行重构** - 严格按设计实施，多参考设计文档和旧代码
6. **编译验证** - 每阶段编译，确保无错误
7. **最终检查** - 对照设计文档逐项验证

---

## 设计文档规范

**必须包含**：

- 功能清单（详细列出所有功能点）
- 目录结构、类职责划分
- 事件/回调分布、数据流向

**禁止包含**：

- 当前问题分析、重构过程说明
- "保留"、"删除"等过程性描述
- 旧版本的文件名/类名

---

## 执行原则

- **严格按设计文档实施**：已设计的照做，不自由发挥
- **禁止擅自修改业务逻辑**：重构只改结构，不改行为
- **多参考旧代码**：确保功能细节不丢失
- **该删就删**：有备份不用担心
- **遇到问题立即停止**：设计变更需确认，禁止擅自修改

---

## 检查清单

**开始前**：

- [ ] 设计规范已确认
- [ ] 设计文档已编写
- [ ] 设计已通过检查
- [ ] 旧代码已备份

**进行中**：

- [ ] 严格按设计实施
- [ ] 每阶段编译验证
- [ ] 问题及时反馈

**完成后**：

- [ ] 编译通过
- [ ] 对照设计文档检查
- [ ] 功能完整性验证
- [ ] 相关规范文档更新
