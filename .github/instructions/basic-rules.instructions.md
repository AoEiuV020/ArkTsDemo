---
applyTo: '**'
---

## 基础约束规则

### 文档约束

- .md文档是给AI看的提示词
- **禁止使用大段代码**：代码示例不超过10行，用关键代码片段说明
- 尽量简洁明了
- 禁止记录修改历史，直接编写最终版本
- 没有明确要求时不要生成新的md文档：用户没有明确说"写个文档"、"生成文档"、"创建md"等要求时，禁止主动创建任何.md文件

### 文件结构约束

- 导出的每个类/接口/枚举尽量单独文件
- 文件名采用 PascalCase（如 `IConnection.ts`）

### 文件组织

- 接口与实现分离
- 每个目录使用 index 统一导出
- 只公开必要的函数，最小化暴露

#### index 文件命名和组织规范

- **index 文件必须使用小写 i**：`index.ts` 或 `index.ets`，禁止使用 `Index.ts` 或 `Index.ets`
- **优先使用目录级 index**：每个子目录应该有自己的 index 文件，上级 index 通过 `export * from './subdir'` 引用
- **避免跨目录直接导出**：index 文件应该只导出本目录或直接子目录的内容，不要跨多层目录直接导出具体文件
- **减少单文件多 export**：如果一个 index 文件有超过 10 个具名 export，考虑为子目录创建独立的 index

### 类型安全

- 尽量避免 any/unknown 动态类型，尽量找出使用具体类型，实在不行才用 object
- 使用 Uint8Array 不用 Buffer
- 基于 protobuf 生成的类型，不重复定义
- 数字枚举优于字符串枚举，除非真的有必要区分值，否则枚举默认自增即可
- 鸿蒙兼容：避免 Node.js 特定 API
- 明确使用export type导出类型适配独立编译模式
- **禁止对非空类型做多余的空判断**，根据接口定义确定的非空类型不需要额外的空检查

### 注释约束

- **注释必须使用中文**：所有代码注释、文档注释都必须使用中文编写

### 语言约束

- **所有能用中文的地方都用中文**：
  - 注释、文档注释：必须中文
  - 错误消息、提示消息：必须中文
  - 日志输出：必须中文
  - 单元测试描述：必须中文
  - 特殊情况：变量名、函数名、类名等标识符使用英文（代码规范）

### 参考约束

- **新增代码必须参考现有实现**：添加新功能时，先查看同类文件的现有实现方式
- **禁止凭空编造用法**：不确定的用法必须先查看现有代码确认
